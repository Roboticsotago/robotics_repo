Stepper motor resonance

According to Haydon Kerk, stepper motors typically have a resonant frequency around 70-120 Hz, although it depends on the entire system (damping, friction, mass, etc.).  Microstepping can reduce the severity.  Acceleration profiles should aim to pass through the resonant band as quickly as possible.

According to Oriental Motor, the resonant frequency is usually around 200 Hz (around 60 RPM for a two-phase motor).  They advise loading a motor to 30-70% of the rated torque, and load inertia should be between 1 and 10 times the rotor inertia (1-3x for short, fast motion applications).  Stepper motors can be "jump started" up to around 1000 pulses/s, to avoid the resonant band altogether.  External damping devices can also be added.

It seems then that the normal mode of operation of a stepper motor is above the renonant frequency.

I've wondered with my delta printer whether it is typically operating above or below the motor resonance.  Assuming delta carriage travel roughly corresponds to print head motion (in terms of speed), and printing speeds of around 40 mm/s:

	pulley: 2 mm x 20 teeth = 40 mm circumference (40 mm/rev)
	motor: 200 steps/rev
	40 mm/rev / 200 step/rev = 0.2 mm/step
	40 mm/s / (0.2 mm/step) = 200 Hz

So, it might not be exceeding the resonant frequency for print moves.  Hmm.

Fast travel moves are probably well above resonance, though: 150 mm/s / (0.2 mm/step) = 750 Hz, though it's notable that I'm seeing sometimes jerky movement when doing fast travel moves at the start or end of a print (between home and bed) (though it doesn't seem to affect the positioning accuracy).  I know the motor driver chips sometimes overheat a little and stutter if there's insufficient cooling.

So, selecting a motor with higher torque than necessary might be a bad idea in terms of resonance?

--

Stepper motor resonant frequency (unloaded?) can be calculated using this formula:

stepper_resonance[num_poles, holding_torque, rotor_inertia] := 100 / (2 pi) * sqrt[2 * num_poles * holding_torque / rotor_inertia ]

For example:

stepper_resonance[2, 20 N cm, 20 g m^2]
100.65842420897407543 s^-1 (frequency)

Resonant frequency can be decreased by:
	decreasing the number of poles
	decreasing the torque
	increasing the rotational inertia

I wonder if it might make sense to add the load inertia to the rotor inertia when calculating system resonance.

--

References:

http://www.haydonkerkpittman.com/learningzone/technicaldocuments/stepper-motor-theory

http://www.orientalmotor.com/stepper-motors/technology/stepper-motor-basics.html

https://www.fxsolver.com/browse/formulas/Motor+Resonance+Frequency
