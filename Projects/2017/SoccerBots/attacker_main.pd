#N canvas 69 53 1531 971 10;
#N canvas 69 81 1280 722 differential_drive 0;
#X obj 309 193 vsl 15 100 -1 1 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 189 1;
#X obj 390 187 vsl 15 100 -1 1 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 9900 1;
#X obj 314 140 +;
#X obj 390 140 +;
#X obj 314 162 clip -1 1;
#X obj 343 110 t b f;
#X obj 403 79 * -1;
#X obj 403 110 t b f;
#X obj 390 162 clip -1 1;
#X obj 251 340 s left_speed;
#X obj 398 343 s right_speed;
#X text 169 -144 forward/ backwards;
#X text 477 -146 left/right;
#X obj 616 -130 inlet;
#X text 563 -155 steering toggle;
#X obj 190 -119 inlet~;
#X obj 690 215 hsl 128 15 10 2000 0 0 empty empty empty -2 -8 0 10
-262144 -1 -1 64 1;
#X obj 487 -124 inlet~;
#X obj 643 173 loadbang;
#X msg 648 196 20;
#X obj 490 -67 *~;
#X obj 256 -121 inlet;
#X obj 190 -67 *~;
#X obj 204 116 tgl 50 1 steering_toggle_out steering_toggle_in empty
17 7 0 10 -262144 -1 -1 1 1;
#X obj 621 -75 s steering_toggle_in;
#X obj 617 -51 r steering_toggle_out;
#X obj 243 -99 s throttle_toggle_in;
#X obj 119 120 tgl 50 1 throttle_toggle_out throttle_toggle_in empty
17 7 0 10 -262144 -1 -1 1 1;
#X obj 242 -73 r throttle_toggle_out;
#X obj 201 228 hsl 60 15 -1 1 0 0 empty steering_drive empty -2 -8
0 10 -262144 -1 -1 0 1;
#X obj 137 205 vsl 15 60 -1 1 0 0 empty throttle_drive empty 0 -9 0
10 -262144 -1 -1 4867 1;
#X obj 190 46 s throttle_drive;
#X obj 491 48 s steering_drive;
#X floatatom 688 195 5 0 0 0 - - -, f 5;
#X obj 191 -43 lop~ 10;
#X obj 492 -44 lop~ 10;
#X obj 654 241 s sampling_period;
#X obj 254 -48 r sampling_period;
#X obj 610 -30 r sampling_period;
#X obj 194 -23 sig2num~;
#X obj 494 -20 sig2num~;
#X connect 0 0 9 0;
#X connect 1 0 10 0;
#X connect 2 0 4 0;
#X connect 3 0 8 0;
#X connect 4 0 0 0;
#X connect 5 0 2 0;
#X connect 5 1 2 1;
#X connect 6 0 7 0;
#X connect 7 0 3 0;
#X connect 7 1 3 1;
#X connect 8 0 1 0;
#X connect 13 0 24 0;
#X connect 15 0 22 0;
#X connect 16 0 33 0;
#X connect 16 0 36 0;
#X connect 17 0 20 0;
#X connect 18 0 19 0;
#X connect 19 0 16 0;
#X connect 20 0 35 0;
#X connect 21 0 26 0;
#X connect 22 0 34 0;
#X connect 25 0 20 1;
#X connect 28 0 22 1;
#X connect 34 0 39 0;
#X connect 35 0 40 0;
#X connect 37 0 39 1;
#X connect 38 0 40 1;
#X connect 39 0 31 0;
#X connect 39 0 2 0;
#X connect 39 0 3 0;
#X connect 40 0 32 0;
#X connect 40 0 6 0;
#X connect 40 0 5 0;
#X coords 0 -1 1 1 170 200 1 100 100;
#X restore 396 419 pd differential_drive;
#X obj 527 377 catch~ steering;
#X obj 1799 51 r ball_detected;
#X obj 1586 53 r range;
#X text 1802 25 IR:;
#X text 1589 25 Ultrasound:;
#N canvas 99 65 895 549 serial-connection 0;
#X obj 223 184 s motor_device;
#X text 216 68 Tell motor-control what serial device to use:;
#X obj 223 90 loadbang;
#X obj 223 112 delay 50;
#X msg 223 136 devicename /dev/serial/by-id/usb-DSpace__www.dspace.org.nz__DSpace_Robot_2.0_55234313335351503221-if00
;
#X obj 116 90 r reconnect;
#X obj 108 119 bng 15 250 50 0 empty empty Connect 17 7 0 10 -262144
-1 -1;
#X msg 128 190 close;
#X obj 108 140 bng 15 250 50 0 empty empty disconnect 17 7 0 10 -262144
-1 -1;
#X text 202 229 TODO: consider using the hostname message to set this.
Actually \, since the two robots will have different control patches
anyway \, this will work perfectly well.;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 0 0;
#X connect 5 0 6 0;
#X connect 6 0 4 0;
#X connect 7 0 0 0;
#X connect 8 0 7 0;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 906 592 pd serial-connection;
#X obj 1577 406 r angle2goal;
#X obj 1578 450 < 10;
#X obj 1577 428 abs;
#X obj 1619 430 tgl 50 0 empty empty facing_goal 17 7 0 10 -262144
-1 -1 0 1;
#X obj 1587 515 r ball_near;
#X obj 1796 80 tgl 50 0 empty empty ball_detected 17 7 0 10 -262144
-1 -1 1 1;
#X floatatom 1587 78 5 0 0 0 - - -, f 5;
#X obj 1580 125 tgl 50 0 empty empty way_is_clear 17 7 0 10 -262144
-1 -1 1 1;
#X obj 1579 180 s way_is_clear;
#X obj 386 377 catch~ throttle;
#X obj 1583 98 expr $f1 == 0 || $f1 >= 16;
#N canvas 69 53 1531 971 seek 0;
#X obj 526 166 r ball_side;
#X text 529 147 Seek mode:;
#X obj 636 199 r~ shoot_mode;
#X obj 522 243 *~;
#X obj 525 189 sig~;
#X obj 636 221 expr~ $v1*-1+1;
#X obj 525 216 expr~ $v1*-1+1;
#X obj 475 309 sig2num~;
#X obj 525 269 s~ seek_mode;
#X obj 120 109 tgl 40 0 empty empty SEEK 35 7 0 30 -262144 -1 -1 0
1;
#X obj 1115 300 throw~ throttle;
#X obj 1171 240 r way_is_clear;
#X obj 1118 266 *~;
#X obj 1001 188 metro;
#X obj 1005 169 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1
0 1;
#X obj 1098 189 * 1000;
#X floatatom 1097 170 5 0 0 0 - - -, f 5;
#X obj 1095 127 loadbang;
#X floatatom 983 279 5 0 0 0 - - -, f 5;
#X obj 1000 215 random 20;
#X obj 1000 237 / 10;
#X obj 1000 259 - 1;
#X obj 942 363 throw~ steering;
#X obj 1100 221 r~ seek_mode;
#X obj 906 254 r~ seek_mode;
#X obj 949 296 *~;
#X obj 1001 296 r way_is_clear;
#X obj 943 322 *~;
#X obj 1001 318 * 0.8;
#X obj 1001 340 + 0.2;
#X obj 1118 244 *~ 0.9;
#X msg 1097 145 4;
#X obj 998 147 loadbang;
#X obj 811 378 sig2num~;
#X obj 267 592 r ball_angle;
#X obj 697 415 r compass_heading;
#X obj 697 514 tgl 50 0 empty empty facing_own_goal 17 7 0 10 -262144
-1 -1 0 1;
#X obj 662 444 abs;
#X obj 662 587 sig~;
#X obj 713 677 throw~ throttle;
#X obj 800 546 loadbang;
#X floatatom 802 599 5 0 0 0 - - -, f 5;
#X obj 709 627 *~;
#X obj 324 418 r compass_heading;
#X obj 320 445 expr if($f1 < 0 \, $f1/180 + 1 \, $f1/180 - 1);
#X obj 484 869 throw~ steering;
#X obj 322 468 sig~;
#X obj 323 502 *~;
#X obj 221 486 loadbang;
#X floatatom 219 538 5 0 0 0 - - -, f 5;
#X msg 801 569 0.5;
#X msg 222 510 0.7;
#X floatatom 291 677 5 0 0 0 - - -, f 5;
#X floatatom 213 616 5 0 0 0 - - -, f 5;
#X obj 271 633 expr if($f1 >= -50 && $f1 <= 0 \, $f1/50 + 1 \, if($f1
> 0 && $f1 <= 50 \, $f1/50 -1 \, 0));
#X obj 177 652 loadbang;
#X floatatom 175 704 5 0 0 0 - - -, f 5;
#X obj 256 698 sig~;
#X obj 238 757 *~;
#X obj 410 732 r~ compass_correct;
#X obj 238 779 s~ ball_correct;
#X obj 323 524 s~ compass_correct;
#X obj 573 734 r~ ball_correct;
#X obj 501 779 +~;
#X msg 178 676 0.3;
#X obj 699 475 expr $f1 <= 200 && $f1 >= 90;
#X obj 496 820 *~;
#X obj 594 805 r~ seek_mode;
#X connect 0 0 4 0;
#X connect 2 0 5 0;
#X connect 3 0 7 0;
#X connect 3 0 8 0;
#X connect 4 0 6 0;
#X connect 5 0 3 1;
#X connect 6 0 3 0;
#X connect 7 0 9 0;
#X connect 11 0 12 1;
#X connect 13 0 19 0;
#X connect 14 0 13 0;
#X connect 15 0 13 1;
#X connect 16 0 15 0;
#X connect 17 0 31 0;
#X connect 18 0 25 1;
#X connect 19 0 20 0;
#X connect 20 0 21 0;
#X connect 21 0 18 0;
#X connect 23 0 30 0;
#X connect 24 0 25 0;
#X connect 25 0 27 0;
#X connect 26 0 28 0;
#X connect 27 0 33 0;
#X connect 28 0 29 0;
#X connect 29 0 27 1;
#X connect 30 0 12 0;
#X connect 31 0 16 0;
#X connect 32 0 14 0;
#X connect 34 0 53 0;
#X connect 34 0 54 0;
#X connect 35 0 37 0;
#X connect 36 0 38 0;
#X connect 37 0 65 0;
#X connect 38 0 42 0;
#X connect 40 0 50 0;
#X connect 41 0 42 1;
#X connect 42 0 39 0;
#X connect 43 0 44 0;
#X connect 44 0 46 0;
#X connect 46 0 47 1;
#X connect 47 0 61 0;
#X connect 48 0 51 0;
#X connect 49 0 47 0;
#X connect 50 0 41 0;
#X connect 51 0 49 0;
#X connect 54 0 52 0;
#X connect 54 0 57 0;
#X connect 55 0 64 0;
#X connect 56 0 58 0;
#X connect 57 0 58 1;
#X connect 58 0 60 0;
#X connect 59 0 63 0;
#X connect 62 0 63 1;
#X connect 63 0 66 0;
#X connect 64 0 56 0;
#X connect 65 0 36 0;
#X connect 66 0 45 0;
#X connect 67 0 66 1;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 466 190 pd seek;
#N canvas 69 53 1531 971 aim 1;
#X text 603 162 Aim mode:;
#X obj 605 184 r ball_side;
#X obj 698 188 r~ shoot_mode;
#X obj 606 231 *~;
#X obj 604 207 sig~;
#X obj 698 210 expr~ $v1*-1+1;
#X obj 583 293 s~ aim_mode;
#X obj 485 211 r ball_detected;
#X obj 606 253 *~;
#X obj 124 111 tgl 40 0 empty empty AIM 33 7 0 30 -262144 -1 -1 1 1
;
#X obj 436 286 sig2num~;
#X obj 588 406 r ball_angle;
#X obj 427 410 r compass_heading;
#X obj 427 454 sig~;
#X obj 591 466 sig~;
#X obj 333 422 loadbang;
#X floatatom 331 474 5 0 0 0 - - -, f 5;
#X obj 417 517 *~;
#X obj 710 418 loadbang;
#X floatatom 708 470 5 0 0 0 - - -, f 5;
#X obj 604 501 *~;
#X obj 489 582 +~;
#X obj 487 658 throw~ steering;
#X obj 530 617 *~;
#X obj 564 562 r~ aim_mode;
#X obj 895 409 loadbang;
#X floatatom 893 461 5 0 0 0 - - -, f 5;
#X msg 896 432 0.2;
#X obj 887 563 throw~ throttle;
#X obj 923 508 *~;
#X obj 954 473 r~ aim_mode;
#X obj 591 429 expr $f1/180.0;
#X obj 427 432 expr $f1/180.0;
#X floatatom 495 466 5 0 0 0 - - -, f 5;
#X floatatom 633 464 5 0 0 0 - - -, f 5;
#X obj 619 616 sig2num~;
#X floatatom 619 638 5 0 0 0 - - -, f 5;
#X obj 404 639 sig2num~;
#X floatatom 404 661 5 0 0 0 - - -, f 5;
#X msg 334 445 0.5;
#X msg 711 441 0.5;
#X connect 1 0 4 0;
#X connect 2 0 5 0;
#X connect 3 0 8 0;
#X connect 4 0 3 0;
#X connect 5 0 3 1;
#X connect 7 0 8 1;
#X connect 8 0 6 0;
#X connect 8 0 10 0;
#X connect 10 0 9 0;
#X connect 11 0 31 0;
#X connect 12 0 32 0;
#X connect 13 0 17 0;
#X connect 14 0 20 0;
#X connect 15 0 39 0;
#X connect 16 0 17 1;
#X connect 17 0 21 0;
#X connect 18 0 40 0;
#X connect 19 0 20 1;
#X connect 20 0 21 1;
#X connect 21 0 23 0;
#X connect 23 0 22 0;
#X connect 23 0 37 0;
#X connect 24 0 23 1;
#X connect 24 0 35 0;
#X connect 25 0 27 0;
#X connect 26 0 29 0;
#X connect 27 0 26 0;
#X connect 29 0 28 0;
#X connect 30 0 29 1;
#X connect 31 0 14 0;
#X connect 31 0 34 0;
#X connect 32 0 13 0;
#X connect 32 0 33 0;
#X connect 35 0 36 0;
#X connect 37 0 38 0;
#X connect 39 0 16 0;
#X connect 40 0 19 0;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 658 187 pd aim;
#N canvas 69 53 1531 971 shoot 0;
#X obj 46 276 tgl 50 0 empty empty ball_near 17 7 0 10 -262144 -1 -1
1 1;
#X obj 45 224 r ball_distance;
#X obj 348 227 r compass_heading;
#X obj 348 249 abs;
#X obj 348 271 < 70;
#X obj 342 293 tgl 50 0 empty empty facing_enemy_goal 17 7 0 10 -262144
-1 -1 1 1;
#N canvas 101 51 895 549 kick? 0;
#X obj 87 154 change;
#X obj 48 263 s kick;
#X obj 87 132 snapshot~;
#X obj 212 83 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 212 57 loadbang;
#X text 88 17 toggles kicker;
#X obj 212 107 metro 10;
#X obj 88 44 inlet~;
#X floatatom 154 153 5 0 0 0 - - -, f 5;
#X floatatom 147 179 5 0 0 0 - - -, f 5;
#X obj 88 77 lop~ 1;
#X obj 87 105 expr~ $v1 >= 0.5;
#X obj 48 207 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 48 185 metro 170;
#X obj 48 243 spigot;
#X obj 87 208 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 14 140 loadbang;
#X obj 48 164 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X connect 0 0 9 0;
#X connect 0 0 15 0;
#X connect 2 0 0 0;
#X connect 2 0 8 0;
#X connect 3 0 6 0;
#X connect 4 0 3 0;
#X connect 6 0 2 0;
#X connect 7 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 2 0;
#X connect 12 0 14 0;
#X connect 13 0 12 0;
#X connect 14 0 1 0;
#X connect 15 0 14 1;
#X connect 16 0 17 0;
#X connect 17 0 13 0;
#X restore 802 685 pd kick?;
#X obj 606 230 r angle2goal;
#X obj 609 256 abs;
#X obj 559 304 tgl 50 0 empty empty Facing_Goal 17 7 0 10 -262144 -1
-1 0 1;
#X obj 45 348 sig~;
#X obj 342 348 sig~;
#X obj 559 359 sig~;
#X text 609 202 Vision:;
#X text 47 199 IR:;
#X text 352 206 Compass:;
#X obj 771 736 s~ shoot_mode;
#X obj 46 251 < 2;
#X obj 775 649 expr~ $v1 * $v2 * $v3 * $v4 * $v5;
#X obj 1336 184 r ball_angle;
#X obj 1338 238 abs;
#X obj 1338 260 < 45;
#X obj 1371 289 tgl 50 0 empty empty facing_ball 17 7 0 10 -262144
-1 -1 1 1;
#X obj 1336 377 sig~;
#X obj 611 279 < 25;
#X floatatom 1364 214 5 0 0 0 - - -, f 5;
#X floatatom 109 665 5 0 0 0 - - -, f 5;
#X obj 112 688 hsl 64 15 -35 35 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 338 1;
#X obj 222 643 < 20;
#X obj 81 764 sig~;
#X obj 78 800 *~;
#X obj 77 901 throw~ steering;
#X obj 224 664 tgl 50 0 empty empty facing_goal 17 7 0 10 -262144 -1
-1 1 1;
#X text 78 612 IR:;
#X text 106 602 controlling steering while shooting for the goal.,
f 29;
#X obj 123 734 r~ shoot_mode;
#X obj 76 636 r angle2goal;
#X obj 79 735 / 35;
#N canvas 401 118 171 119 diy_pwm 0;
#X obj 18 59 outlet~;
#X obj 18 15 phasor~ 1;
#X obj 18 37 expr~ $v1 < 0.15;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X restore 127 828 pd diy_pwm;
#X obj 79 827 *~;
#X obj 214 762 tgl 75 0 empty empty shoot_mode 17 7 0 10 -262144 -1
-1 0 1;
#X obj 123 734 r~ shoot_mode;
#X obj 219 890 throw~ throttle;
#X obj 289 843 r way_is_clear;
#X obj 220 871 *~;
#X obj 79 849 *~ 1.2;
#X floatatom 224 719 5 0 0 0 - - -, f 5;
#X obj 220 849 *~ 0.25;
#X obj 136 769 sig2num~;
#X obj 121 110 tgl 40 0 empty empty SHOOT 35 7 0 30 -262144 -1 -1 0
1;
#X obj 634 671 sig2num~;
#X obj 779 51 r compass_heading;
#X obj 960 62 r ball_angle;
#X obj 860 310 wrap;
#X obj 860 259 / 360;
#X obj 860 281 + 0.5;
#X obj 860 354 * 360;
#X obj 860 332 - 0.5;
#X floatatom 860 376 5 0 0 0 - - -, f 5;
#X floatatom 819 149 5 0 0 0 - - -, f 5;
#X floatatom 928 127 5 0 0 0 - - -, f 5;
#X obj 820 177 * -1;
#X obj 864 214 +;
#X obj 864 236 abs;
#X obj 863 447 tgl 40 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 925 175 t b f;
#X floatatom 958 266 5 0 0 0 - - -, f 5;
#X obj 855 408 expr $f1 <= 90 && $f1 >= -90;
#X obj 902 497 s ball_side;
#X obj 841 517 sig~;
#X connect 0 0 10 0;
#X connect 1 0 17 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 11 0;
#X connect 7 0 8 0;
#X connect 8 0 24 0;
#X connect 9 0 12 0;
#X connect 10 0 18 0;
#X connect 11 0 18 1;
#X connect 12 0 18 2;
#X connect 17 0 0 0;
#X connect 18 0 6 0;
#X connect 18 0 16 0;
#X connect 18 0 50 0;
#X connect 19 0 25 0;
#X connect 19 0 20 0;
#X connect 20 0 21 0;
#X connect 21 0 22 0;
#X connect 21 0 23 0;
#X connect 23 0 18 4;
#X connect 24 0 9 0;
#X connect 26 0 27 0;
#X connect 28 0 32 0;
#X connect 29 0 30 0;
#X connect 30 0 39 0;
#X connect 32 0 46 0;
#X connect 35 0 30 1;
#X connect 35 0 47 0;
#X connect 35 0 48 0;
#X connect 36 0 28 0;
#X connect 36 0 37 0;
#X connect 36 0 26 0;
#X connect 37 0 29 0;
#X connect 38 0 39 1;
#X connect 39 0 45 0;
#X connect 43 0 44 1;
#X connect 44 0 42 0;
#X connect 45 0 31 0;
#X connect 47 0 44 0;
#X connect 48 0 40 0;
#X connect 50 0 49 0;
#X connect 51 0 59 0;
#X connect 52 0 60 0;
#X connect 53 0 57 0;
#X connect 54 0 55 0;
#X connect 55 0 53 0;
#X connect 56 0 58 0;
#X connect 57 0 56 0;
#X connect 58 0 67 0;
#X connect 59 0 61 0;
#X connect 60 0 65 0;
#X connect 61 0 62 0;
#X connect 62 0 63 0;
#X connect 63 0 66 0;
#X connect 63 0 54 0;
#X connect 64 0 68 0;
#X connect 64 0 69 0;
#X connect 65 0 62 0;
#X connect 65 1 62 1;
#X connect 67 0 64 0;
#X connect 69 0 18 3;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 294 188 pd shoot;
#X connect 1 0 0 2;
#X connect 2 0 12 0;
#X connect 3 0 13 0;
#X connect 7 0 9 0;
#X connect 8 0 10 0;
#X connect 9 0 8 0;
#X connect 13 0 17 0;
#X connect 14 0 15 0;
#X connect 16 0 0 0;
#X connect 17 0 14 0;
