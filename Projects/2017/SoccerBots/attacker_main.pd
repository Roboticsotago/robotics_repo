#N canvas -9 157 1265 628 10;
#N canvas 149 178 952 540 differential_drive 0;
#X obj 310 220 vsl 15 100 -1 1 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 4950 1;
#X obj 390 228 vsl 15 100 -1 1 0 0 empty empty empty 0 -9 0 10 -262144
-1 -1 4950 1;
#X obj 314 140 +;
#X obj 390 140 +;
#X obj 314 162 clip -1 1;
#X obj 343 110 t b f;
#X obj 403 79 * -1;
#X obj 403 110 t b f;
#X obj 390 162 clip -1 1;
#X obj 251 340 s left_speed;
#X obj 398 343 s right_speed;
#X text 169 -144 forward/ backwards;
#X text 477 -146 left/right;
#X obj 616 -130 inlet;
#X text 563 -155 steering toggle;
#X obj 190 -119 inlet~;
#X obj 690 215 hsl 128 15 10 2000 0 0 empty empty empty -2 -8 0 10
-262144 -1 -1 64 1;
#X obj 487 -124 inlet~;
#X obj 643 173 loadbang;
#X msg 648 196 20;
#X obj 490 -67 *~;
#X obj 256 -121 inlet;
#X obj 190 -67 *~;
#X obj 204 116 tgl 50 1 steering_toggle_out steering_toggle_in empty
17 7 0 10 -262144 -1 -1 1 1;
#X obj 621 -75 s steering_toggle_in;
#X obj 617 -51 r steering_toggle_out;
#X obj 243 -99 s throttle_toggle_in;
#X obj 119 120 tgl 50 1 throttle_toggle_out throttle_toggle_in empty
17 7 0 10 -262144 -1 -1 1 1;
#X obj 242 -73 r throttle_toggle_out;
#X obj 201 228 hsl 60 15 -1 1 0 0 empty steering_drive empty -2 -8
0 10 -262144 -1 -1 2950 1;
#X obj 137 205 vsl 15 60 -1 1 0 0 empty throttle_drive empty 0 -9 0
10 -262144 -1 -1 2950 1;
#X obj 190 46 s throttle_drive;
#X obj 491 48 s steering_drive;
#X floatatom 688 195 5 0 0 0 - - -, f 5;
#X obj 191 -43 lop~ 10;
#X obj 492 -44 lop~ 10;
#X obj 654 241 s sampling_period;
#X obj 254 -48 r sampling_period;
#X obj 610 -30 r sampling_period;
#X obj 194 -23 sig2num~;
#X obj 494 -20 sig2num~;
#X obj 340 191 * 0.8;
#X obj 406 195 * 0.8;
#X connect 0 0 9 0;
#X connect 1 0 10 0;
#X connect 2 0 4 0;
#X connect 3 0 8 0;
#X connect 4 0 41 0;
#X connect 5 0 2 0;
#X connect 5 1 2 1;
#X connect 6 0 7 0;
#X connect 7 0 3 0;
#X connect 7 1 3 1;
#X connect 8 0 42 0;
#X connect 13 0 24 0;
#X connect 15 0 22 0;
#X connect 16 0 33 0;
#X connect 16 0 36 0;
#X connect 17 0 20 0;
#X connect 18 0 19 0;
#X connect 19 0 16 0;
#X connect 20 0 35 0;
#X connect 21 0 26 0;
#X connect 22 0 34 0;
#X connect 25 0 20 1;
#X connect 28 0 22 1;
#X connect 34 0 39 0;
#X connect 35 0 40 0;
#X connect 37 0 39 1;
#X connect 38 0 40 1;
#X connect 39 0 31 0;
#X connect 39 0 2 0;
#X connect 39 0 3 0;
#X connect 40 0 32 0;
#X connect 40 0 6 0;
#X connect 40 0 5 0;
#X connect 41 0 0 0;
#X connect 42 0 1 0;
#X coords 0 -1 1 1 170 200 1 100 100;
#X restore 13 229 pd differential_drive;
#X obj 120 201 catch~ steering;
#N canvas 99 65 895 549 serial-connection 0;
#X obj 223 184 s motor_device;
#X text 216 68 Tell motor-control what serial device to use:;
#X obj 223 90 loadbang;
#X obj 223 112 delay 50;
#X msg 223 136 devicename /dev/serial/by-id/usb-DSpace__www.dspace.org.nz__DSpace_Robot_2.0_55234313335351503221-if00
;
#X obj 116 90 r reconnect;
#X obj 108 119 bng 15 250 50 0 empty empty Connect 17 7 0 10 -262144
-1 -1;
#X msg 128 190 close;
#X obj 108 140 bng 15 250 50 0 empty empty disconnect 17 7 0 10 -262144
-1 -1;
#X text 202 229 TODO: consider using the hostname message to set this.
Actually \, since the two robots will have different control patches
anyway \, this will work perfectly well.;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 0 0;
#X connect 5 0 6 0;
#X connect 6 0 4 0;
#X connect 7 0 0 0;
#X connect 8 0 7 0;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 24 443 pd serial-connection;
#X obj 12 201 catch~ throttle;
#N canvas 20 136 1265 628 seek 0;
#X obj 119 105 tgl 50 0 empty empty SEEK 46 7 0 30 -262144 -1 -1 0
1;
#X obj 362 62 r ball_side;
#X obj 362 84 not;
#X obj 404 167 sig~;
#X obj 404 189 s~ seek_mode;
#X obj 114 55 r~ seek_mode;
#X obj 114 77 sig2num~;
#X obj 471 106 t b f;
#X text 345 19 When to activate seek mode;
#X obj 470 61 r ball_near;
#X obj 470 83 not;
#X obj 595 62 r round_mode;
#X obj 595 84 not;
#X obj 595 106 t b f;
#X obj 407 139 expr $f1 * $f2 * $f3;
#X connect 1 0 2 0;
#X connect 2 0 14 0;
#X connect 3 0 4 0;
#X connect 5 0 6 0;
#X connect 6 0 0 0;
#X connect 7 0 14 0;
#X connect 7 1 14 1;
#X connect 9 0 10 0;
#X connect 10 0 7 0;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 13 0 14 0;
#X connect 13 1 14 2;
#X connect 14 0 3 0;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 44 108 pd seek;
#N canvas -145 308 1265 643 aim 0;
#X obj 119 105 tgl 50 0 empty empty AIM 46 7 0 30 -262144 -1 -1 0 1
;
#X obj 114 77 sig2num~;
#X obj 114 55 r~ aim_mode;
#X obj 326 63 r ball_side;
#X obj 464 124 +;
#X obj 527 88 t b f;
#X obj 417 278 sig~;
#X obj 408 305 s~ aim_mode;
#X obj 465 149 >= 1;
#X obj 422 201 *;
#X obj 461 174 t b f;
#X text 380 3 When to activate aim mode;
#X obj 425 63 r ball_near;
#X obj 528 63 r facing_goal;
#X obj 646 62 r~ shoot_mode;
#X obj 643 128 t b f;
#X obj 646 107 sig2num~;
#X obj 422 236 *;
#X obj 646 84 not~;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X connect 3 0 9 0;
#X connect 4 0 8 0;
#X connect 5 0 4 0;
#X connect 5 1 4 1;
#X connect 6 0 7 0;
#X connect 8 0 10 0;
#X connect 9 0 17 0;
#X connect 10 0 9 0;
#X connect 10 1 9 1;
#X connect 12 0 4 0;
#X connect 13 0 5 0;
#X connect 14 0 18 0;
#X connect 15 0 17 0;
#X connect 15 1 17 1;
#X connect 16 0 15 0;
#X connect 17 0 6 0;
#X connect 18 0 16 0;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 666 110 pd aim;
#N canvas 8 105 1265 660 shoot 0;
#X obj 119 105 tgl 50 0 empty empty SHOOT 46 7 0 30 -262144 -1 -1 0
1;
#X obj 114 77 sig2num~;
#X obj 114 54 r~ shoot_mode;
#X obj 289 80 r ball_side;
#X obj 388 78 r ball_near;
#X obj 500 77 r facing_goal;
#X obj 304 158 expr $f1 * $f2 * $f3;
#X obj 304 180 sig~;
#X obj 304 202 s~ shoot_mode;
#X obj 495 110 t b f;
#X obj 385 109 t b f;
#X text 325 33 When to activate shoot mode;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X connect 3 0 6 0;
#X connect 4 0 10 0;
#X connect 5 0 9 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 9 0 6 0;
#X connect 9 1 6 2;
#X connect 10 0 6 0;
#X connect 10 1 6 1;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 928 104 pd shoot;
#X obj 419 277 r ball_angle;
#X floatatom 419 299 5 0 0 0 - - -, f 5;
#X obj 775 272 r compass_heading;
#X floatatom 775 298 5 0 0 0 - - -, f 5;
#X obj 679 298 tgl 40 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 286 275 r ball_detected;
#X obj 286 299 tgl 40 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 544 272 r ball_distance;
#X obj 383 331 hsl 128 15 -180 180 0 0 empty empty empty -2 -8 0 10
-262144 -1 -1 10125 1;
#X obj 447 717 r way_is_clear;
#X obj 447 740 not;
#X obj 446 796 bang;
#X obj 430 942 throw~ throttle;
#X obj 447 821 delay 5000;
#X obj 555 800 r way_is_clear;
#X obj 348 822 delay 1000;
#X msg 354 857 0;
#X msg 558 846 stop;
#X obj 461 902 sig~;
#X msg 448 850 -0.75;
#X text 558 693 drive backwards if the robot is stuck for 5 seconds
, f 18;
#X obj 394 786 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 314 822 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 401 722 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 447 762 change;
#N canvas 8 60 1265 628 round 0;
#X obj 119 105 tgl 50 0 empty empty ROUND 46 7 0 30 -262144 -1 -1 0
1;
#X obj 314 48 r ball_side;
#X obj 314 70 not;
#X obj 356 129 *;
#X obj 356 151 sig~;
#X obj 421 77 t b f;
#X text 310 17 When to activate round mode;
#X obj 424 48 r ball_near;
#X obj 679 129 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 677 64 sig2num~;
#X obj 677 87 change;
#X obj 677 109 moses 1;
#X obj 672 189 spigot;
#X obj 703 146 delay 50;
#X msg 707 167 0;
#X msg 869 274 1;
#X obj 674 349 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 784 147 loadbang;
#X msg 784 169 1;
#X obj 666 314 delay 5000;
#X obj 356 170 s~ possible_round_mode;
#X msg 685 233 1;
#X obj 677 42 r~ possible_round_mode;
#X msg 703 337 0;
#X floatatom 634 215 5 0 0 0 - - -, f 5;
#X obj 634 236 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 683 213 change;
#X obj 685 261 s round_mode;
#X obj 703 367 s round_mode;
#X obj 114 55 r round_mode;
#X obj 95 478 throw~ steering;
#X obj 92 259 r round_mode;
#X obj 187 260 loadbang;
#X obj 111 319 *;
#X obj 94 455 sig~;
#X obj 344 540 throw~ throttle;
#X obj 537 540 throw~ steering;
#X obj 317 389 loadbang;
#X obj 568 390 loadbang;
#X obj 443 257 r round_mode;
#X obj 355 441 *;
#X obj 443 279 t b f;
#X obj 526 442 *;
#X obj 350 497 sig~;
#X obj 529 506 sig~;
#X obj 918 353 r ball_angle;
#X obj 439 425 t b f;
#X obj 356 466 *;
#X obj 526 464 *;
#X obj 96 396 spigot;
#X obj 160 312 r circle;
#X obj 918 397 change;
#X obj 918 419 moses 1;
#X obj 918 442 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 900 483 spigot;
#X obj 962 443 delay 10;
#X msg 962 465 0;
#X obj 903 529 s circle;
#X obj 1045 395 r round_mode;
#X obj 1045 417 change;
#X obj 1045 439 moses 1;
#X msg 1045 461 1;
#X obj 1081 462 s circle;
#X obj 879 511 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 438 387 r circle;
#X floatatom 114 290 5 0 0 0 - - -, f 5;
#X floatatom 918 375 5 0 0 0 - - -, f 5;
#X obj 94 432 *;
#X obj 13 423 t b f;
#X floatatom 163 458 5 0 0 0 - - -, f 5;
#X obj 165 335 change;
#X obj 165 357 moses 1;
#X msg 165 379 0;
#X obj 13 379 r circle;
#X obj 13 401 not;
#X obj 36 301 moses 1;
#X msg 900 505 1;
#X msg 53 345 0;
#X obj 234 322 r round_mode;
#X obj 234 352 moses 1;
#X msg 234 374 1;
#X obj 1106 195 r circle;
#X floatatom 1106 217 5 0 0 0 - - -, f 5;
#X floatatom 142 418 5 0 0 0 - - -, f 5;
#X obj 36 323 delay 100;
#X msg 335 411 1;
#X msg 187 282 -0.25;
#X obj 965 374 == 80;
#X msg 568 412 0.85;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 20 0;
#X connect 5 0 3 0;
#X connect 5 1 3 1;
#X connect 7 0 5 0;
#X connect 8 0 12 0;
#X connect 8 0 13 0;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 1 8 0;
#X connect 12 0 19 0;
#X connect 12 0 24 0;
#X connect 12 0 25 0;
#X connect 12 0 26 0;
#X connect 13 0 14 0;
#X connect 14 0 12 1;
#X connect 15 0 12 1;
#X connect 17 0 18 0;
#X connect 18 0 12 1;
#X connect 19 0 15 0;
#X connect 19 0 16 0;
#X connect 19 0 23 0;
#X connect 21 0 27 0;
#X connect 22 0 9 0;
#X connect 23 0 28 0;
#X connect 26 0 21 0;
#X connect 29 0 0 0;
#X connect 31 0 33 0;
#X connect 31 0 65 0;
#X connect 31 0 75 0;
#X connect 32 0 86 0;
#X connect 33 0 49 0;
#X connect 34 0 30 0;
#X connect 37 0 85 0;
#X connect 38 0 88 0;
#X connect 39 0 41 0;
#X connect 40 0 47 0;
#X connect 41 0 40 0;
#X connect 41 0 42 0;
#X connect 41 1 40 1;
#X connect 41 1 42 1;
#X connect 42 0 48 0;
#X connect 43 0 35 0;
#X connect 44 0 36 0;
#X connect 45 0 66 0;
#X connect 45 0 87 0;
#X connect 46 0 47 0;
#X connect 46 0 48 0;
#X connect 46 1 47 1;
#X connect 46 1 48 1;
#X connect 47 0 43 0;
#X connect 48 0 44 0;
#X connect 49 0 67 0;
#X connect 49 0 83 0;
#X connect 50 0 70 0;
#X connect 51 0 52 0;
#X connect 52 1 53 0;
#X connect 53 0 55 0;
#X connect 53 0 54 0;
#X connect 54 0 63 0;
#X connect 54 0 76 0;
#X connect 55 0 56 0;
#X connect 56 0 54 1;
#X connect 58 0 59 0;
#X connect 59 0 60 0;
#X connect 60 0 61 0;
#X connect 60 0 62 0;
#X connect 61 0 54 1;
#X connect 64 0 46 0;
#X connect 67 0 34 0;
#X connect 67 0 69 0;
#X connect 68 0 67 0;
#X connect 68 1 67 1;
#X connect 70 0 71 0;
#X connect 71 0 72 0;
#X connect 72 0 49 1;
#X connect 73 0 74 0;
#X connect 74 0 68 0;
#X connect 75 0 84 0;
#X connect 76 0 57 0;
#X connect 77 0 49 0;
#X connect 78 0 79 0;
#X connect 79 0 80 0;
#X connect 80 0 49 1;
#X connect 81 0 82 0;
#X connect 84 0 77 0;
#X connect 85 0 40 0;
#X connect 86 0 33 1;
#X connect 87 0 51 0;
#X connect 88 0 42 0;
#X coords 0 -1 1 1 85 60 1 100 100;
#X restore 346 105 pd round;
#X text 28 18 Seek Mode: Active when the ball is NOT between us and
the goal \, and we are not close to the ball. Purpose is to get close
to the ball., f 29;
#X text 324 24 Round Mode: Active when the ball is NOT between us and
the goal and we are close to the ball. Purpose is to get the ball between
us and the target goal., f 38;
#X text 663 27 Aim Mode: Active when the ball is between us and the
target goal but we cannot see the goal or we are not close to the ball.
Purpose is to line up the ball up with the goal, f 35;
#X text 928 34 Shoot Mode: Active when ball is directly between the
robot and the goal. Purpose is to score!, f 30;
#X obj 916 271 r angle2goal;
#X obj 917 315 < 10;
#X obj 916 293 abs;
#X obj 956 295 tgl 50 0 empty empty facing_goal 17 7 0 10 -262144 -1
-1 0 1;
#X obj 916 351 s facing_goal;
#X obj 550 344 s ball_near;
#X obj 679 271 r ball_side;
#X obj 524 344 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X floatatom 544 294 5 0 0 0 - - -, f 5;
#X obj 591 295 >= 130;
#X connect 1 0 0 2;
#X connect 3 0 0 0;
#X connect 7 0 8 0;
#X connect 8 0 15 0;
#X connect 9 0 10 0;
#X connect 12 0 13 0;
#X connect 14 0 45 0;
#X connect 14 0 46 0;
#X connect 16 0 17 0;
#X connect 17 0 31 0;
#X connect 18 0 20 0;
#X connect 18 0 30 0;
#X connect 20 0 26 0;
#X connect 20 0 22 0;
#X connect 20 0 28 0;
#X connect 21 0 24 0;
#X connect 22 0 23 0;
#X connect 22 0 29 0;
#X connect 23 0 25 0;
#X connect 24 0 20 0;
#X connect 24 0 22 0;
#X connect 25 0 19 0;
#X connect 26 0 25 0;
#X connect 31 0 18 0;
#X connect 37 0 39 0;
#X connect 38 0 40 0;
#X connect 38 0 41 0;
#X connect 39 0 38 0;
#X connect 43 0 11 0;
#X connect 46 0 42 0;
#X connect 46 0 44 0;
